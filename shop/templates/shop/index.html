<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Responsive Layout</title>

    <!-- External CSS Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

    <style>
        /* ==========================================================================
           BASE STYLES
           ========================================================================== */
        * {
            box-sizing: border-box;
        }

        body {
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }

        /* ==========================================================================
           LAYOUT COMPONENTS
           ========================================================================== */
        .main-container {
            height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .container-fluid {
            flex-grow: 1;
            overflow: hidden;
        }

        /* ==========================================================================
           SWIPER STYLES
           ========================================================================== */
        .swiper {
            width: 100%;
            height: 60vh;
        }

        .swiper-slide {
            text-align: center;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            width: 100%;
        }

        .swiper-slide img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ==========================================================================
           COLLECTION & PRODUCT STYLES
           ========================================================================== */
        .collection {
            height: 100%;
            overflow-y: auto;
        }

        .right_column {
            height: 60vh;
            overflow-y: auto;
        }

        .right_column .block {
            height: 30vh;
            overflow: hidden;
        }

        .products {
            height: 40vh;
        }

        .product {
            border: 1px solid black;
        }

        .product img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        /* ==========================================================================
           DROPDOWN STYLES
           ========================================================================== */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: -100px;
            z-index: 1000;
            display: none;
            background-color: white;
            min-width: 150px;
            padding: 0.5rem 0;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 0.25rem;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-menu a {
            display: block;
            padding: 8px 16px;
            color: black;
            text-decoration: none;
        }

        .dropdown-menu a:hover {
            background-color: #f1f1f1;
        }

        button {
            background: none;
            border: none;
            cursor: pointer;
        }

        /* ==========================================================================
           SIDEBAR STYLES
           ========================================================================== */
        .side-menu {
            width: 280px;
            background: #ffffff;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .offcanvas-header {
            padding: 24px;
            border-bottom: 1px solid #e2e8f0;
            background-color: #ffffff;
        }

        .logo-box {
            font-size: 20px;
            font-weight: 600;
            color: #1e293b;
            letter-spacing: -0.025em;
        }

        .btn-close {
            width: 32px;
            height: 32px;
            background-color: #f1f5f9;
            border-radius: 8px;
            opacity: 0.6;
            transition: all 0.2s ease;
        }

        .btn-close:hover {
            opacity: 1;
            background-color: #e2e8f0;
        }

        .offcanvas-body {
            padding: 24px;
            background-color: #ffffff;
        }

        /* Search Section */
        .search-container {
            margin-bottom: 32px;
        }

        .search-container .form-control {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 14px;
            background-color: #ffffff;
            transition: border-color 0.2s ease;
        }

        .search-container .form-control:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-container .btn-primary {
            background-color: #3b82f6;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .search-container .btn-primary:hover {
            background-color: #2563eb;
            border-color: #2563eb;
        }

        /* Section Headers */
        .section-title {
            font-size: 13px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 16px;
            padding-left: 4px;
        }

        .section-spacing {
            margin-bottom: 32px;
        }

        /* Menu Lists */
        .menu-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .menu-list li {
            margin-bottom: 4px;
        }

        .dropdown-item {
            display: block;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 400;
            color: #475569;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .dropdown-item:hover {
            background-color: #f8fafc;
            color: #1e293b;
            text-decoration: none;
        }

        /* Highlighted Item */
        .text-highlight {
            background-color: #fef2f2;
            color: #dc2626 !important;
            font-weight: 500;
            border: 1px solid #fecaca;
        }

        .text-highlight:hover {
            background-color: #fee2e2;
            color: #b91c1c !important;
            border-color: #fca5a5;
        }

        /* ==========================================================================
           MEDIA QUERIES
           ========================================================================== */
        @media (max-width: 1080px) {
            .swiper {
                height: 40vh;
            }

            .right_column {
                height: 30vh;
                overflow-y: auto;
            }

            .right_column .block {
                height: 30vh;
                overflow: hidden;
            }

            .products {
                height: 40vh;
            }
        }

        @media (max-width: 480px) {
            .swiper {
                height: 25vh;
            }

            .right_column {
                height: 30vh;
                overflow-y: auto;
            }

            .right_column .block {
                height: 30vh;
                overflow: hidden;
            }

            .products {
                height: 45vh;
                border: 3px solid #f1f1f1;
                overflow-y: auto;
            }

            .product {
                height: 22.5vh;
            }

            /* Sidebar Mobile Responsive */
            .side-menu {
                width: 100%;
            }

            .offcanvas-header,
            .offcanvas-body {
                padding: 20px;
            }
        }

        @media (max-width: 576px) {
            .side-menu {
                width: 100%;
            }

            .offcanvas-header,
            .offcanvas-body {
                padding: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="main-container">
        <!-- ==========================================================================
             NAVIGATION BAR
             ========================================================================== -->
        <nav class="navbar navbar-light bg-white border-bottom px-3 position-sticky">
            <!-- Menu Button -->
            <button class="btn btn-link" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu">
                <img src="{% static 'image/icons/menu.png' %}" height="25" alt="Menu">
            </button>

            <!-- Logo -->
            <div class="logo-box" style="border-radius: 6px 8px; overflow: hidden;">
                <img src="{% static 'image/logo/logo.jpg' %}" height="45" alt="Logo">
            </div>

            <!-- Right Side Icons -->
            <div class="d-flex">
                <!-- Shopping Cart -->
                <button class="text-reset" style="background: none; border: none;">
                    <i class="fas fa-shopping-cart" style="border:1px solid #272424; padding: 5px; border-radius: 3px; font-size: 20px;"></i>
                    <span class="badge rounded-pill badge-notification bg-danger" id="cart_items">
                        {{order.total_items}}
                    </span>
                </button>

                <!-- User Profile Dropdown -->
                <div class="dropdown" id="userDropdownWrapper">
                    <button id="userBtn">
                        <img src="{% static 'image/icons/user.png' %}" height="25" alt="User" />
                    </button>
                    <div class="dropdown-menu" id="userDropdown">
                        <a href="/myorder">My Order</a>
                        {% if request.user.is_authenticated %}
                        <a href="{% url 'logout' %}">Logout</a>
                        {% else %}
                        <a href="{% url 'login' %}">Login</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </nav>

        <!-- ==========================================================================
             SIDEBAR MENU
             ========================================================================== -->
        <div class="offcanvas offcanvas-start side-menu" tabindex="-1" id="sidebarMenu">
            <!-- Sidebar Header -->
            <div class="offcanvas-header">
                <div class="logo-box" style="border-radius: 10px 12px; overflow: hidden;">
                    <img src="{% static 'image/logo/logo.jpg' %}" height="70" alt="Logo">
                </div>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
            </div>

            <!-- Sidebar Body -->
            <div class="offcanvas-body">
                <!-- Search Section -->
                <div class="d-flex mb-3 search-container">
                    <input type="text" class="form-control me-2" placeholder="Search by name, keyword" />
                    <button class="btn btn-dark btn-sm">Search</button>
                </div>

                <!-- Collections Section -->
                <div class="section-spacing">
                    <p class="section-title">Collection</p>
                    <ul class="menu-list">
                        {% for collection in heroCollections %}
                        <li>
                            <a class="dropdown-item" href="/shop-grid/{{collection.id}}">
                                {{collection.name}}
                            </a>
                        </li>
                        {% endfor %}

                        {% for collection in collectionsets %}
                        {% if collection.name == "DISCOUNT OFFERS" %}
                        <li>
                            <a class="dropdown-item text-highlight" href="/shop-grid/{{collection.id}}">
                                Discount Products
                            </a>
                        </li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>

                <!-- Categories Section -->
                <div>
                    <p class="section-title">Category</p>
                    <ul class="menu-list">
                        {% for category in all_categories %}
                        <li>
                            <a class="dropdown-item" href="{% url 'products' category.id %}">
                                {{category.name}}
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        <!-- ==========================================================================
             MAIN CONTENT GRID
             ========================================================================== -->
        <div class="" style="width: 100%;">
            <div class="row">
                <!-- ==========================================================================
                     LEFT COLUMN - HERO SWIPER
                     ========================================================================== -->
                <div class="collection col-lg-8 col-12" style="padding: 0px;">
                    <div class="swiper mySwiper">
                        <div class="swiper-wrapper">
                            {% for collection in heroCollections %}
                            <div class="swiper-slide">
                                <picture style="width: 100%; height: 100%;">
                                    <source media="(max-width: 480px)" srcset="{{collection.mobileimageURL}}" 
                                            style="width: 100%;" class="mobile-image">
                                    <img src="{{collection.imageURL}}" 
                                         class="hero-image desktop-image h-100"
                                         style="height: 100%;" 
                                         loading="lazy"
                                         alt="Collection: {{collection.name}}">
                                </picture>
                            </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <!-- ==========================================================================
                     RIGHT COLUMN - COLLECTION GRID
                     ========================================================================== -->
                <div class="col-lg-4 right_column p-0">
                    <div class="row w-100 h-100 m-0">
                        {% for collection in collectionsets %}
                        <div class="col-6 col-md-6 col-lg-12 p-0 " style="border-color: #000000;">
                            <picture class="w-100 h-100 d-block">
                                <source media="(max-width: 480px)" srcset="{{ collection.mobileimageURL }}">
                                <img src="{{ collection.imageURL }}"
                                     class="hero-image desktop-image w-100 h-100 d-block" 
                                     style="object-fit: cover;"
                                     loading="lazy" 
                                     alt="Collection: {{ collection.name }}">
                            </picture>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- ==========================================================================
                 PRODUCTS SECTION
                 ========================================================================== -->
            <div class="row bg-info products">
                {% for product in top_rated_product %}
                <div class="col-lg-2 col-4" style="padding: 0;">
                    <a href="{% url 'shop_details' product.slug %}">
                        <div class="product">
                            <img src="{{product.imageURL}}" 
                                 class="card-img-top" 
                                 alt="Product: {{product.name}}">
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- ==========================================================================
         JAVASCRIPT LIBRARIES
         ========================================================================== -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- ==========================================================================
         CUSTOM JAVASCRIPT
         ========================================================================== -->
    <script>
        // ==========================================================================
        // USER DROPDOWN FUNCTIONALITY
        // ==========================================================================
        const userBtn = document.getElementById('userBtn');
        const userDropdown = document.getElementById('userDropdown');
        const userDropdownWrapper = document.getElementById('userDropdownWrapper');

        userBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // prevent click bubbling
            userDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!userDropdownWrapper.contains(e.target)) {
                userDropdown.classList.remove('show');
            }
        });

        // ==========================================================================
        // SWIPER INITIALIZATION
        // ==========================================================================
        var swiper = new Swiper(".mySwiper", {
            direction: "vertical",
            slidesPerView: 1,
            spaceBetween: 30,
            mousewheel: true,
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true,
            },
        });

        // ==========================================================================
        // UTILITY FUNCTIONS
        // ==========================================================================
        function toggleMenu() {
            alert("Menu button clicked! (Replace with your logic)");
        }
    </script>
</body>

</html>